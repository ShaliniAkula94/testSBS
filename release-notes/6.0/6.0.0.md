# Release Notes

## [Stable release 6.0.0] - 2024-12-09

This update brings the below changes over the previous stable release:

### Contributors
Many thanks to the following public contributors! Their efforts toward furthering this project are very much appreciated!

- [0xced](https://github.com/0xced)
- [deadlydog](https://github.com/deadlydog)
- [EamonHetherton](https://github.com/EamonHetherton)
- [edwardneal](https://github.com/edwardneal)
- [ErikEJ](https://github.com/ErikEJ)
- [Markeli](https://github.com/Markeli)
- [MichelZ](https://github.com/MichelZ)
- [mus65](https://github.com/mus65)
- [SimonCropp](https://github.com/SimonCropp)
- [TrayanZapryanov](https://github.com/TrayanZapryanov)
- [twsouthwick](https://github.com/twsouthwick)
- [wilbit](https://github.com/wilbit)
- [Wraith2](https://github.com/Wraith2)

### Breaking Changes

- Removed support for .NET Standard. [#2386](https://github.com/dotnet/SqlClient/pull/2386), since Preview 1
- Removed support for .NET 6 [#2927](https://github.com/dotnet/SqlClient/pull/2927), since Preview 3
- Removed UWP (uap) references. [#2483](https://github.com/dotnet/SqlClient/pull/2483), since Preview 1
- Removed SQL 2000 client-side debugging support for .NET Framework [#2981](https://github.com/dotnet/SqlClient/pull/2981), [#2940](https://github.com/dotnet/SqlClient/pull/2940), since Preview 3

### Added

- Added support for .NET 9 [#2946](https://github.com/dotnet/SqlClient/pull/2946), since Preview 3
- Added localization in Czech, Polish, and Turkish [#2987](https://github.com/dotnet/SqlClient/pull/2987), since Preview 3
- Added `TokenCredential` object to take advantage of token caching in `ActiveDirectoryAuthenticationProvider`. [#2380](https://github.com/dotnet/SqlClient/pull/2380), since Preview 1
- Added `DateOnly` and `TimeOnly` support to `DataTable` as a structured parameter. [#2258](https://github.com/dotnet/SqlClient/pull/2258), since Preview 1
- Added `Microsoft.Data.SqlClient.Diagnostics.SqlClientDiagnostic` type in .NET. [#2226](https://github.com/dotnet/SqlClient/pull/2226), since Preview 1
- Added scope trace for `GenerateSspiClientContext`. [#2497](https://github.com/dotnet/SqlClient/pull/2497), [#2725](https://github.com/dotnet/SqlClient/pull/2725), since Preview 1
- Added support for JSON datatype [#2916](https://github.com/dotnet/SqlClient/pull/2916), [#2892](https://github.com/dotnet/SqlClient/pull/2892), [#2891](https://github.com/dotnet/SqlClient/pull/2891), [#2880](https://github.com/dotnet/SqlClient/pull/2880), [#2882](https://github.com/dotnet/SqlClient/pull/2882), [#2829](https://github.com/dotnet/SqlClient/pull/2829), [#2830](https://github.com/dotnet/SqlClient/pull/2830), since Preview 2
- Added readme to nuget package [#2826](https://github.com/dotnet/SqlClient/pull/2826), since Preview 2
- Enabled NuGet package auditing via NuGet.org audit source [#3024](https://github.com/dotnet/SqlClient/pull/3024), since Preview 3
- Added missing SqlCommand_BeginExecuteReader code sample [#3009](https://github.com/dotnet/SqlClient/pull/3009), since Preview 3
- Added support for SqlConnectionOverrides in OpenAsync() API [#2433](https://github.com/dotnet/SqlClient/pull/2433), since Preview 3

### Fixed

- Fixed `Socket.Connect` timeout issue caused by thread starvation. [#2777](https://github.com/dotnet/SqlClient/pull/2777), since Preview 1
- Fixed pending data with `SqlDataReader` against an encrypted column. [#2618](https://github.com/dotnet/SqlClient/pull/2618), since Preview 1
- Fixed Entra authentication when using infinite connection timeout in `ActiveDirectoryAuthenticationProvider`. [#2651](https://github.com/dotnet/SqlClient/pull/2651), since Preview 1
- Fixed `GetSchema` by excluding unsupported engines due to lack of support for `ASSEMBLYPROPERTY` function. [#2593](https://github.com/dotnet/SqlClient/pull/2593), since Preview 1
- Fixed SSPI retry negotiation with default port in .NET. [#2559](https://github.com/dotnet/SqlClient/pull/2559), since Preview 1
- Fixed assembly path in .NET 8.0 and `.AssemblyAttributes`. [#2550](https://github.com/dotnet/SqlClient/pull/2550), since Preview 1
- Fixed certificate chain validation. [#2487](https://github.com/dotnet/SqlClient/pull/2487), since Preview 1
- Fixed clone of `SqlConnection` to include `AccessTokenCallback`. [#2525](https://github.com/dotnet/SqlClient/pull/2525), since Preview 1
- Fixed issue with `DateTimeOffset` in table-valued parameters, which was introduced in 5.2. [#2453](https://github.com/dotnet/SqlClient/pull/2453), since Preview 1
- Fixed `ArgumentNullException` on `SqlDataRecord.GetValue` when using user-defined data type on .NET. [#2448](https://github.com/dotnet/SqlClient/pull/2448), since Preview 1
- Fixed `SqlBuffer` and `SqlGuild` when it's null. [#2310](https://github.com/dotnet/SqlClient/pull/2310), since Preview 1
- Fixed `SqlBulkCopy.WriteToServer` state in a consecutive calls. [#2375](https://github.com/dotnet/SqlClient/pull/2375)
- Fixed null reference exception with `SqlConnection.FireInfoMessageEventOnUserErrors` after introducing the batch command. [#2399](https://github.com/dotnet/SqlClient/pull/2399), since Preview 1
- Fixed scale serialization when explicitly set to 0 [#2411](https://github.com/dotnet/SqlClient/pull/2411), since Preview 2
- Fixed issue blocking `GetSchema` commands from being enrolled into the current transaction [#2876](https://github.com/dotnet/SqlClient/pull/2876), since Preview 2
- Adjusted retry logic to allow errors with negative numbers to be considered transient [#2896](https://github.com/dotnet/SqlClient/pull/2896), since Preview 2
- Fixed string formatting in `OutOfMemory` exceptions [#2797](https://github.com/dotnet/SqlClient/pull/2797), since Preview 2
- Increased routing attempts to 10 in netcore for `LoginNoFailover` and added routing support to `LoginWithFailover` to standardize routing behavior between netcore and netfx [#2873](https://github.com/dotnet/SqlClient/pull/2873), since Preview 2
- Restructured documentation into XML format so that it displays correctly in Visual Studio [#2836](https://github.com/dotnet/SqlClient/pull/2836), [#2822](https://github.com/dotnet/SqlClient/pull/2822), [#2834](https://github.com/dotnet/SqlClient/pull/2834), [#2851](https://github.com/dotnet/SqlClient/pull/2851), [#2863](https://github.com/dotnet/SqlClient/pull/2863), [#2864](https://github.com/dotnet/SqlClient/pull/2864), [#2865](https://github.com/dotnet/SqlClient/pull/2865), [#2869](https://github.com/dotnet/SqlClient/pull/2869), [#2871](https://github.com/dotnet/SqlClient/pull/2871), [#2837](https://github.com/dotnet/SqlClient/pull/2837), [#2821](https://github.com/dotnet/SqlClient/pull/2821), since Preview 2
- Fixed cleanup behavior when column decryption fails. Prevents leaving stale data on the wire for pooled connections [#2843](https://github.com/dotnet/SqlClient/pull/2843), [#2825](https://github.com/dotnet/SqlClient/pull/2825), since Preview 2
- Reverted default value of `UseMinimumLoginTimeout` context switch to 'true' [#2419](https://github.com/dotnet/SqlClient/pull/2419), since Preview 3
- Added missing `DynamicallyAccessedMembers` attributes in .NET Runtime reference assemblies. [#2946](https://github.com/dotnet/SqlClient/pull/2946), since Preview 3
- Synchronized dependencies of reference assemblies with runtime assemblies [#2878](https://github.com/dotnet/SqlClient/pull/2878), since Preview 3
- Fixed lazy initialization of the `_SqlMetaData` hidden column map for .NET Framework [#2964](https://github.com/dotnet/SqlClient/pull/2964), since Preview 3

### Changed

- Dependency changes
  - Added dependency on `Microsoft.Bcl.Cryptography:9.0.0` [#2946](https://github.com/dotnet/SqlClient/pull/2946), since Preview 2
  - Added dependency on `System.Security.Cryptography.Pkcs:9.0.0` to address [SYSLIB0057](https://learn.microsoft.com/en-us/dotnet/fundamentals/syslib-diagnostics/syslib0057)[#2946](https://github.com/dotnet/SqlClient/pull/2946), since Preview 3
  - Added dependency on `System.Text.Json` `8.0.5` for .NET 8+ and `6.0.10` for other versions [#2921](https://github.com/dotnet/SqlClient/pull/2921), since Preview 2
  - Removed dependency on  `Microsoft.Extensions.Caching.Memory` and `System.Security.Cryptography.Cng`, which were unnecessary after removing .NET Standard. [#2577](https://github.com/dotnet/SqlClient/pull/2577), since Preview 1
  - Removed dependency on `System.Text.Json` from .NET 8+ [#2930](https://github.com/dotnet/SqlClient/pull/2930), since Preview 3
  - Removed direct dependency to `Microsoft.Identity.Client` to take the transient dependecy through `Azure.Identity`. [#2577](https://github.com/dotnet/SqlClient/pull/2577), since Preview 1
  - Replaced `System.Runtime.Caching` with `Microsoft.Extensions.Caching.Memory`. [#2493](https://github.com/dotnet/SqlClient/pull/2493), since Preview 1
  - Updated `Azure.Core` version from `1.35.0` to `1.38.0`. [#2462](https://github.com/dotnet/SqlClient/pull/2462), since Preview 1
  - Updated `Azure.Identity` version from `1.10.3` to `1.11.4`. [#2577](https://github.com/dotnet/SqlClient/pull/2577), since Preview 1
  - Updated `Azure.Security.KeyVault.Keys` version from `4.4.0` to `4.5.0`. [#2462](https://github.com/dotnet/SqlClient/pull/2462), since Preview 1
  - Updated `Microsoft.Data.SqlClient.SNI` version to `6.0.0-preview1.24226.4`. [#2772](https://github.com/dotnet/SqlClient/pull/2772), since Preview 1
  - Updated `Microsoft.IdentityModel.JsonWebTokens` and `Microsoft.IdentityModel.Protocols.OpenIdConnect` from `6.35.0` to `7.5.0`. [#2429](https://github.com/dotnet/SqlClient/pull/2429), since Preview 1
  - Updated `Microsoft.Extensions.Caching.Memory` from `8.0.0` to `9.0.0` [#2921](https://github.com/dotnet/SqlClient/pull/2921), since Preview 3
  - Updated `System.Configuration.ConfigurationManager` from `8.0.0` to `9.0.10` for .NET 8 [#2921](https://github.com/dotnet/SqlClient/pull/2921), since Preview 2
- Improved access to `SqlAuthenticationProviderManager.Instance` and avoid early object initiation. [#2636](https://github.com/dotnet/SqlClient/pull/2636), since Preview 1
- Removed undocumented properties of `Azure.Identity` in `ActiveDirectoryAuthenticationProvider`. [#2562](https://github.com/dotnet/SqlClient/pull/2562), since Preview 1
- Updated `EnableOptimizedParameterBinding` to only accept text mode commands. [#2417](https://github.com/dotnet/SqlClient/pull/2417), since Preview 1
- Improved memory allocation when reader opened by `CommandBehavior.SequentialAccess` over the big string columns. [#2356](https://github.com/dotnet/SqlClient/pull/2356), since Preview 1
- Improved SSPI by consolidating the context generation to single abstraction and using memory/span for SSPI generation. [#2255](https://github.com/dotnet/SqlClient/pull/2255), [#2447](https://github.com/dotnet/SqlClient/pull/2447), since Preview 1
- Reverted the [#2281](https://github.com/dotnet/SqlClient/pull/2281) code changes on ManagedSNI. [#2395](https://github.com/dotnet/SqlClient/pull/2395), since Preview 1
- Updated assembly version to 6.0.0.0. [#2382](https://github.com/dotnet/SqlClient/pull/2382), since Preview 1
- Updated docs to use absolute links [#2949](https://github.com/dotnet/SqlClient/pull/2949), since Preview 3
- Code health improvements:
  - Since preview 1: [#2366](https://github.com/dotnet/SqlClient/pull/2366), [#2369](https://github.com/dotnet/SqlClient/pull/2369), [#2381](https://github.com/dotnet/SqlClient/pull/2381), [#2390](https://github.com/dotnet/SqlClient/pull/2390), [#2392](https://github.com/dotnet/SqlClient/pull/2392), [#2403](https://github.com/dotnet/SqlClient/pull/2403), [#2410](https://github.com/dotnet/SqlClient/pull/2410), [#2413](https://github.com/dotnet/SqlClient/pull/2413), [#2425](https://github.com/dotnet/SqlClient/pull/2425), [#2428](https://github.com/dotnet/SqlClient/pull/2428), [#2440](https://github.com/dotnet/SqlClient/pull/2440), [#2443](https://github.com/dotnet/SqlClient/pull/2443), [#2450](https://github.com/dotnet/SqlClient/pull/2450), [#2466](https://github.com/dotnet/SqlClient/pull/2466), [#2486](https://github.com/dotnet/SqlClient/pull/2486), [#2521](https://github.com/dotnet/SqlClient/pull/2521), [#2522](https://github.com/dotnet/SqlClient/pull/2522), [#2533](https://github.com/dotnet/SqlClient/pull/2533), [#2552](https://github.com/dotnet/SqlClient/pull/2552), [#2560](https://github.com/dotnet/SqlClient/pull/2560), [#2726](https://github.com/dotnet/SqlClient/pull/2726), [#2751](https://github.com/dotnet/SqlClient/pull/2751), [#2811](https://github.com/dotnet/SqlClient/pull/2811)
  - Since preview 2: [#2915](https://github.com/dotnet/SqlClient/pull/2915), [#2844](https://github.com/dotnet/SqlClient/pull/2844), [#2812](https://github.com/dotnet/SqlClient/pull/2812), [#2805](https://github.com/dotnet/SqlClient/pull/2805), [#2897](https://github.com/dotnet/SqlClient/pull/2897), [#2376](https://github.com/dotnet/SqlClient/pull/2376), [#2814](https://github.com/dotnet/SqlClient/pull/2814), [#2889](https://github.com/dotnet/SqlClient/pull/2889), [#2885](https://github.com/dotnet/SqlClient/pull/2885), [#2854](https://github.com/dotnet/SqlClient/pull/2854), [#2835](https://github.com/dotnet/SqlClient/pull/2835), [#2442](https://github.com/dotnet/SqlClient/pull/2442), [#2820](https://github.com/dotnet/SqlClient/pull/2820), [#2831](https://github.com/dotnet/SqlClient/pull/2831), [#2907](https://github.com/dotnet/SqlClient/pull/2907), [#2910](https://github.com/dotnet/SqlClient/pull/2910), [#2898](https://github.com/dotnet/SqlClient/pull/2898), [#2928](https://github.com/dotnet/SqlClient/pull/2928), [#2929](https://github.com/dotnet/SqlClient/pull/2929), [#2936](https://github.com/dotnet/SqlClient/pull/2936), [#2939](https://github.com/dotnet/SqlClient/pull/2939)

## Target Platform Support
- .NET Framework 4.6.2+ (Windows x64, Windows x86)
- .NET 8.0+ (Linux, macOS, Windows ARM, Windows ARM64, Windows x64, Windows x86)

### Dependencies

#### .NET Framework
- Azure.Identity 1.11.4
- Microsoft.Bcl.Cryptography 9.0.0
- Microsoft.Data.SqlClient.SNI 6.0.0-preview1.24226.4
- Microsoft.Extensions.Caching.Memory 9.0.0
- Microsoft.IdentityModel.JsonWebTokens 7.5.0
- Microsoft.IdentityModel.Protocols.OpenIdConnect 7.5.0
- System.Buffers 4.5.1
- System.Security.Cryptography.Pkcs 9.0.0
- System.Text.Encodings.Web 6.0.0
- System.Text.Json 6.0.10

#### .NET 8

- Azure.Identity 1.11.4
- Microsoft.Bcl.Cryptography 9.0.0
- Microsoft.Data.SqlClient.SNI.runtime 6.0.0-preview1.24226.4
- Microsoft.Extensions.Caching.Memory 9.0.0
- Microsoft.IdentityModel.JsonWebTokens 7.5.0
- Microsoft.IdentityModel.Protocols.OpenIdConnect 7.5.0
- Microsoft.SqlServer.Server 1.0.0
- System.Configuration.ConfigurationManager 9.0.0
- System.Security.Cryptography.Pkcs 9.0.0

#### .NET 9

- Azure.Identity 1.11.4
- Microsoft.Bcl.Cryptography 9.0.0
- Microsoft.Data.SqlClient.SNI.runtime 6.0.0-preview1.24226.4
- Microsoft.Extensions.Caching.Memory 9.0.0
- Microsoft.IdentityModel.JsonWebTokens 7.5.0
- Microsoft.IdentityModel.Protocols.OpenIdConnect 7.5.0
- Microsoft.SqlServer.Server 1.0.0
- System.Configuration.ConfigurationManager 9.0.0
- System.Security.Cryptography.Pkcs 9.0.0