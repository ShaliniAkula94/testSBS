<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <ProjectGuid>{407890AC-9876-4FEF-A6F1-F36A876BAADE}</ProjectGuid>
    <RootNamespace>SqlClient</RootNamespace>
    <TargetFramework>net462</TargetFramework>
    <EnableLocalAppContext>true</EnableLocalAppContext>
    <ResxFileName>Strings</ResxFileName>
    <ResourceFileName>SqlClient.Resources.$(ResxFileName)</ResourceFileName>
    <GeneratedSourceFileName>$(ResxFileName).ResourceNames.cs</GeneratedSourceFileName>
    <AssemblyName>Microsoft.Data.SqlClient</AssemblyName>
    <OutputPlatform>AnyCPU</OutputPlatform>
    <BinPath>$(BinFolder)$(Configuration).$(OutputPlatform)\</BinPath>
    <ObjPath>$(ObjFolder)$(Configuration).$(OutputPlatform)\</ObjPath>
    <OutputPath>$(BinPath)$(AssemblyName)\netfx\</OutputPath>
    <DocumentationFile>$(OutputPath)\Microsoft.Data.SqlClient.xml</DocumentationFile>
    <IntermediateOutputPath>$(ObjPath)$(AssemblyName)\netfx\</IntermediateOutputPath>
    <AppendTargetFrameworkToOutputPath>false</AppendTargetFrameworkToOutputPath>
    <EnableDefaultEmbeddedResourceItems>false</EnableDefaultEmbeddedResourceItems>
    <Product>Framework $(BaseProduct)</Product>
    <!-- ResolveComReferenceSilent suppresses warnings thrown due to the inclusion of mscoree.
     We should remove ResolveComReferenceSilent as soon as we can remove the dependency on mscoree. -->
    <ResolveComReferenceSilent>True</ResolveComReferenceSilent>
    <DefineConstants>$(DefineConstants);NETFRAMEWORK;</DefineConstants>
  </PropertyGroup>
  <PropertyGroup>
    <TargetFrameworkMonikerAssemblyAttributesPath>$([System.IO.Path]::Combine('$(IntermediateOutputPath)','$(GeneratedSourceFileName)'))</TargetFrameworkMonikerAssemblyAttributesPath>
  </PropertyGroup>
  <PropertyGroup>
    <!-- CSC Compiler Options -->
    <NoConfig>True</NoConfig>
    <AllowUnsafeBlocks>True</AllowUnsafeBlocks>
    <CheckForOverflowUnderflow>False</CheckForOverflowUnderflow>
    <NoWarn>1701,1702</NoWarn>
    <GenerateFullPaths>True</GenerateFullPaths>
    <NoStandardLib>True</NoStandardLib>
    <WarningLevel>4</WarningLevel>
    <FileAlignment>512</FileAlignment>
    <HighEntropyVA>True</HighEntropyVA>
    <DebugSymbols>True</DebugSymbols>
    <NoLogo>True</NoLogo>
    <SubsystemVersion>6.00</SubsystemVersion>
    <OutputType>Library</OutputType>
    <TreatWarningsAsErrors>True</TreatWarningsAsErrors>
    <Utf8Output>True</Utf8Output>
    <ErrorReport>None</ErrorReport>
    <CodeAnalysisRuleSet>MinimumRecommendedRules.ruleset</CodeAnalysisRuleSet>
    <BuildProjectReferences>True</BuildProjectReferences>
    <GenerateAssemblyRefs>True</GenerateAssemblyRefs>
    <DefineConstants>$(DefineConstants);USEOFFSET;CODE_ANALYSIS_BASELINE;FEATURE_LEGACYSURFACEAREA;FEATURE_UTF32;FEATURE_UTF7;TRACE;</DefineConstants>
    <!-- Preprocess properties -->
    <AllowPartialTrustedCalls>true</AllowPartialTrustedCalls>
    <AssemblyKeyType>ECMA</AssemblyKeyType>
    <!-- the RawClDefines was the only way to get AssemblyAttributes.cs to not include [SecurityRules] which break the link step -->
    <GenerateAssemblyAttribute>true</GenerateAssemblyAttribute>
    <RawClDefines>$(RawClDefines);SUPPRESS_SECURITY_RULES=1</RawClDefines>
    <!-- ADO.NET internal defines -->
    <UseOwnAssemblyVersionOnly Condition="'$(AdoNetService)'=='true'">true</UseOwnAssemblyVersionOnly>
    <DefineConstants Condition="'$(AdoNetService)'=='true'">$(DefineConstants);ADONET_SERVICE;ADONET_CERT_AUTH;ADONET_ORIGINAL_CLIENT_ADDRESS</DefineConstants>
    <ComCompatibleSideBySide>True</ComCompatibleSideBySide>
    <GenerateTargetFrameworkAttribute>False</GenerateTargetFrameworkAttribute>
  </PropertyGroup>
  <!-- ********************** Configuration and Platform specific properties ********************* -->
  <!-- All Available Configurations-->
  <PropertyGroup Condition="$(Configuration.Contains('Debug'))">
    <DefineConstants>$(DefineConstants);DEBUG;DBG;_DEBUG;_LOGGING;RESOURCE_ANNOTATION_WORK;</DefineConstants>
    <DebugType>Full</DebugType>
    <Optimize>False</Optimize>
  </PropertyGroup>
  <PropertyGroup Condition="$(Configuration.Contains('Release'))">
    <DefineConstants>$(DefineConstants);RETAIL;</DefineConstants>
    <DebugType>Pdbonly</DebugType>
    <Optimize>True</Optimize>
  </PropertyGroup>
  <PropertyGroup>
    <DefineConstants>$(DefineConstants);NETFRAMEWORK;</DefineConstants>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Configuration" />
    <Reference Include="System.Runtime.Serialization" />
    <Reference Include="System.Security" />
    <Reference Include="System.Data" />
    <Reference Include="System.Xml" />
    <Reference Include="System.Runtime.Caching" />
    <Reference Include="System.Transactions" />
    <Reference Include="System.EnterpriseServices" />
  </ItemGroup>
  <!-- Contains common items shared between NetFx and NetCore -->
  <ItemGroup>
    <Compile Include="..\..\src\Microsoft\**\*.cs">
      <Link>Microsoft\%(RecursiveDir)%(Filename).common%(Extension)</Link>
    </Compile>
    <Compile Include="..\..\src\Resources\**\*.cs" LinkBase="Resources">
    </Compile>
  </ItemGroup>
  <ItemGroup>
    <Compile Remove="..\..\src\Microsoft\**\*.unix.cs" />
    <Compile Remove="..\..\src\Microsoft\**\*.netcore.cs" />
  </ItemGroup>
  <ItemGroup>
    <Compile Remove="..\..\src\Microsoft\Data\SqlClient\EnclaveDelegate.NotSupported.cs" />
    <Compile Remove="..\..\src\Microsoft\Data\SqlClient\SqlDependencyUtils.AppDomain.cs" />
    <Compile Remove="..\..\src\Microsoft\Data\SqlClient\SqlDependencyUtils.AssemblyLoadContext.cs" />
    <Compile Remove="..\..\src\Microsoft\Data\SqlClient\SqlEnclaveAttestationParameters.NotSupported.cs" />
    <Compile Remove="..\..\src\Microsoft\Data\Sql\SqlDataSourceEnumeratorManagedHelper.cs" />
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="Resources\$(ResxFileName).resx">
      <LogicalName>Microsoft.Data.SqlClient.Resources.Strings.resources</LogicalName>
      <CustomToolNamespace>System</CustomToolNamespace>
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>$(ResxFileName).Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <EmbeddedResource Include="Resources\$(ResxFileName).*.resx" />
    <EmbeddedResource Include="Resources\Microsoft.Data.SqlClient.SqlMetaData.xml">
      <LogicalName>Microsoft.Data.SqlClient.SqlMetaData.xml</LogicalName>
      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
    </EmbeddedResource>
  </ItemGroup>
  <ItemGroup>
    <COMReference Include="mscoree">
      <Guid>{5477469E-83B1-11D2-8B49-00A0C9B7C9C4}</Guid>
      <VersionMajor>2</VersionMajor>
      <VersionMinor>4</VersionMinor>
      <Lcid>0</Lcid>
      <WrapperTool>tlbimp</WrapperTool>
      <Isolated>False</Isolated>
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </COMReference>
  </ItemGroup>
  <ItemGroup>
    <PackageReference Condition="$(BuildForRelease) == 'true'" Include="Microsoft.SourceLink.GitHub" Version="$(MicrosoftSourceLinkGitHubVersion)" PrivateAssets="All" />
    <PackageReference Include="System.Text.Encodings.Web">
      <Version>$(SystemTextEncodingsWebVersion)</Version>
    </PackageReference>
    <PackageReference Include="System.Security.Cryptography.Algorithms">
      <Version>$(SystemSecurityCryptographyAlgorithmsVersion)</Version>
    </PackageReference>
    <PackageReference Include="System.Security.Cryptography.Primitives">
      <Version>$(SystemSecurityCryptographyPrimitivesVersion)</Version>
    </PackageReference>
    <PackageReference Include="Microsoft.Data.SqlClient.SNI">
      <Version>$(MicrosoftDataSqlClientSniVersion)</Version>
      <PrivateAssets>All</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
    </PackageReference>
    <PackageReference Include="Azure.Identity">
      <Version>$(AzureIdentityVersion)</Version>
    </PackageReference>
    <PackageReference Include="Microsoft.Identity.Client">
      <Version>$(MicrosoftIdentityClientVersion)</Version>
    </PackageReference>
    <PackageReference Include="Microsoft.IdentityModel.Protocols.OpenIdConnect">
      <version>$(MicrosoftIdentityModelProtocolsOpenIdConnectVersion)</version>
    </PackageReference>
    <PackageReference Include="Microsoft.IdentityModel.JsonWebTokens">
      <version>$(MicrosoftIdentityModelJsonWebTokensVersion)</version>
    </PackageReference>
    <PackageReference Include="System.Buffers">
      <Version>$(SystemBuffersVersion)</Version>
    </PackageReference>
    <PackageReference Include="System.IO">
      <Version>$(SystemIOVersion)</Version>
    </PackageReference>
  </ItemGroup>
  <Import Project="$(NetFxSource)tools\targets\GenerateResourceStringsSource.targets" />
  <Import Project="$(NetFxSource)tools\targets\GenerateThisAssemblyCs.targets" />
  <Import Project="$(NetFxSource)tools\targets\GenerateAssemblyRef.targets" />
  <Import Project="$(NetFxSource)tools\targets\GenerateAssemblyInfo.targets" />
</Project>
